<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>B·ªëc L√¨ X√¨</title>
    <style>
        body { background: #8b0000; color: white; text-align: center; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 15px; padding: 20px; }
        .lixi { 
            height: 150px; background: #ce1f1f; border: 2px solid gold; border-radius: 10px;
            display: flex; align-items: center; justify-content: center; font-size: 40px; cursor: pointer;
        }
        .lixi.sold-out { opacity: 0; pointer-events: none; } /* Bi·∫øn m·∫•t ho√†n to√†n */
        .result-overlay { position: fixed; top: 0; background: rgba(0,0,0,0.9); width: 100%; height: 100%; display: none; justify-content: center; align-items: center; flex-direction: column; }
    </style>
</head>
<body>
    <h1>üßß CH·ªåN L√å X√å MAY M·∫ÆN üßß</h1>
    <div class="grid" id="container"> ƒêang t·∫£i d·ªØ li·ªáu... </div>

    <div class="result-overlay" id="overlay">
        <h2 id="win-text"></h2>
        <button onclick="location.reload()">ƒê√≥ng</button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // --- D√ÅN C√ôNG CONFIG NH∆Ø FILE ADMIN ---
        const firebaseConfig = { ... }; 

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        onValue(ref(db, 'lixi_pool'), (snapshot) => {
            const data = snapshot.val();
            const container = document.getElementById('container');
            container.innerHTML = '';
            
            data.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'lixi' + (item.status === 'opened' ? ' sold-out' : '');
                card.innerHTML = 'üßß';
                card.onclick = () => pick(index, item.val);
                container.appendChild(card);
            });
        });

        function pick(index, value) {
            if(confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn b·ªëc bao n√†y?")) {
                update(ref(db, `lixi_pool/${index}`), { status: 'opened' }).then(() => {
                    document.getElementById('overlay').style.display = 'flex';
                    document.getElementById('win-text').innerText = "B·∫°n nh·∫≠n ƒë∆∞·ª£c " + value + "k!";
                });
            }
        }
    </script>
</body>
</html>